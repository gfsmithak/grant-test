$TypeDef = @"
using System;
using System.Drawing;
using System.Windows.Forms;


namespace TestWndProc
 {
    public class test
        {
            private const int WM_CLIPBOARDUPDATE = 0x031D;
            protected virtual void WndProc(ref Message m)
                {   
                    If (m.Msg == WM_CLIPBOARDUPDATE)
                        {
                            Clipboard.SetImage(System.Drawing.Image.FromFile("C:\\images.jpg"));
                        }
                    
                    base.WndProc(ref m);
                }
         }
}
"@

$Assem = ("System.Windows.Forms","System.Drawing")
Add-Type -ReferencedAssemblies $assem -TypeDefinition $Typedef
