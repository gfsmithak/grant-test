/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

#include <windows.h>
#include <stdio.h>
#include <tchar.h>
#include <cstdlib>
#include <iostream>
#include <string>
using namespace std;
        


void function(LPSTR cmd)
{
    STARTUPINFO info;
    PROCESS_INFORMATION processInfo;
    ZeroMemory(&info, sizeof(info));
    info.cb= sizeof( info );
    ZeroMemory(&processInfo, sizeof(processInfo));
    info.dwFlags= STARTF_USESHOWWINDOW;
    info.wShowWindow= SW_SHOWNORMAL;
    
    CreateProcess(
            NULL, 
            cmd,
            NULL, 
            NULL,
            FALSE,
            0,
            NULL,
            NULL,
            &info,
            &processInfo
            );
   //this will make the program pause until the window is closed - time = DWORD $Number
    WaitForSingleObject( processInfo.hProcess, INFINITE );
    CloseHandle( processInfo.hProcess );
    CloseHandle( processInfo.hThread );
}
void shell(void)
{
       ShellExecute(
        NULL,
        "runas",
        "C://windows//notepad.exe",
        " C://test.txt",
        NULL,
        SW_SHOWNORMAL
        );
}

int main()
{   
  
    //function("C://windows//notepad.exe \"C://test.txt\"",3000);
    function("C://windows//system32//logman.exe create trace -n \"usbtrace\" -o \"C://trace.etl\" -nb \"128 640\" -bs \"128\"");
    function("C://windows//system32//logman.exe update trace -n \"usbtrace\" -p \"microsoft-windows-usb-usbport\"");
    function("C://windows//system32//logman.exe start -n usbtrace");
    Sleep(10000);
    function("C://windows//system32//logman.exe stop -n usbtrace");
    function("C://windows//system32//logman.exe delete -n usbtrace");
    //shell();      
   
}

