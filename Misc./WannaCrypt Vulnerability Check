try {
new-eventlog -logname application -source "VulnCheck"
}
catch {
continue
}
$WUAPI = New-Object -ComObject "Microsoft.Update.Session"
$Searcher = $WUAPI.CreateUpdateSearcher()
$Updates = $Searcher.GetTotalHistoryCount()
If (!($Searcher.QueryHistory(0, $Updates) | ? {$_.title -like "*KB4012215*" -or $_.title -like "*KB4012212*"})){
Write-eventlog -logname Application -Source VulnCheck -entrytype Information -EventID 1 -message "KBs not installed"
}

else {
Write-eventlog -logname Application -Source VulnCheck -entrytype Information -EventID 2 -message "KBs are installed"
}
