<#Silly way of obfuscating code. The function converts a given command to a series of null-arrays, which can then be decoded back into
the original command. To run the obfuscated command, you can invoke it like so:

From file: iex ([system.text.encoding]::utf8.getstring((get-content $OutputPath | foreach {(iex $_)})))
From variable: iex ([system.text.encoding]::utf8.getstring(($obfcode | foreach {(iex $_)})))

#>
Function obfuscate-mycode {
[cmdletbinding()]
param(
[parameter(mandatory=$true)]
[string[]]$MyCode,
[parameter(mandatory=$false)]
[string[]]$OutputPath
)
$Command=($mycode).tochararray()
$global:ObfCode=switch ($command) {

a {'("$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
b {'("$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
c {'("$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))”)'}
d {'("$((!@())+(!!@()))"+"$((!!@())+(!!@()))"+"$((!!@())+(!!@()))")'}
e {'("$((!@())+(!!@()))"+"$((!!@())+(!!@()))"+"$((!@())+(!!@()))")'}
f {'("$((!@())+(!!@()))"+"$((!!@())+(!!@()))"+”$((!@())+(!@()))”)'}
g {'("$((!@())+(!!@()))"+"$((!!@())+(!!@()))"+"$((!@())+(!@())+(!@()))")'}
h {'("$((!@())+(!!@()))"+"$((!!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@()))")'}
i {'("$((!@())+(!!@()))"+"$((!!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@()))")'}
j {'("$((!@())+(!!@()))"+"$((!!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
k {'("$((!@())+(!!@()))"+"((!!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
l {'("$((!@())+(!!@()))"+"$((!!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
m {'("$((!@())+(!!@()))"+"$((!!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
n {'("$((!@())+(!!@()))"+"$((!@())+(!!@()))"+"$((!!@())+(!!@()))")'}
o {'("$((!@())+(!!@()))"+"$((!@())+(!!@()))"+"$((!@())+(!!@()))")'}
p {'("$((!@())+(!!@()))"+"$((!@())+(!!@()))"+"$((!@())+(!@()))")'}
q {'("$((!@())+(!!@()))"+"$((!@())+(!!@()))"+"$((!@())+(!@())+(!@()))")'}
r {'("$((!@())+(!!@()))"+"$((!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@()))")'}
s {'("$((!@())+(!!@()))"+"$((!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@()))")'}
t {'("$((!@())+(!!@()))"+"$((!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
u {'("$((!@())+(!!@()))"+"$((!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
v {'("$((!@())+(!!@()))"+"$((!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
w {'("$((!@())+(!!@()))"+"$((!@())+(!!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
x {'("$((!@())+(!!@()))"+"$((!@())+(!@()))"+"$((!!@())+(!!@()))")'}
y {'("$((!@())+(!!@()))"+"$((!@())+(!@()))"+"$((!@())+(!!@()))")'}
z {'("$((!@())+(!!@()))"+"$((!@())+(!@()))"+"$((!@())+(!@())")'}
0 {'("$((!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
1 {'("$((!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
2 {'("$((!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!!@())+(!!@()))")'}
3 {'("$((!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!!@()))")'}
4 {'("$((!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@()))")'}
5 {'("$((!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@()))")'}
6 {'("$((!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@()))")'}
7 {'("$((!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@()))")'}
8 {'("$((!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
9 {'("$((!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
`! {'("$((!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@()))")'}
`" {'("$((!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@()))")'}
`# {'("$((!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@()))")'}
`$ {'("$((!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
`% {'("$((!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
`& {'("$((!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
`' {'("$((!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
`( {'("$((!@())+(!@())+(!@())+(!@()))"+"$((!!@())+(!!@()))")'}
`) {'("$((!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!!@()))")'}
`* {'("$((!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@()))")'}
`+ {'("$((!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@()))")'}
`, {'("$((!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@()))")'}
`- {'("$((!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@()))")'}
`. {'("$((!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
`/ {'("$((!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
`{ {'("$((!@())+(!!@()))"+"$((!@())+(!@()))"+"$((!@())+(!@())+(!@()))")'}
`| {'("$((!@())+(!!@()))"+"$((!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@()))")'}
`} {'("$((!@())+(!!@()))"+"$((!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@()))")'}
`= {'("$((!@())+(!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!!@()))")'}
`: {'("$((!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
`; {'("$((!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))")'}
`[ {'("$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!!@()))")'}
`] {'("$((!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@())+(!@()))"+"$((!@())+(!@())+(!@()))")'} 
" " {'("$((!@())+(!@())+(!@()))"+"$((!@())+(!@()))")'}
}
if ($outputpath -ne $null) {$ObfCode | out-file "$Outputpath"}
}

